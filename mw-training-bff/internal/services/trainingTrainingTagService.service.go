package services

import (
	"context"
	"mw-training-bff/internal/schemas"

	pb "mw-training-bff/pkg/grpcAutogenerated/training"
)

type TrainingTrainingTagService struct {
	trainingTrainingTagGRPC pb.TrainingTrainingTagServiceClient
}

func NewTrainingTrainingTagService(
	trainingTrainingTagGRPC pb.TrainingTrainingTagServiceClient,
) *TrainingTrainingTagService {
	return &TrainingTrainingTagService{trainingTrainingTagGRPC}
}

type CreateTrainingTrainingTagParams struct {
	TrainingUuid string
	TagName      string
}

func (ttts *TrainingTrainingTagService) CreateTrainingTrainingTag(ctx context.Context, params *CreateTrainingTrainingTagParams) (*schemas.TrainingTag, error) {
	trainingTag, err := ttts.trainingTrainingTagGRPC.CreateTrainingTrainingTag(ctx, &pb.CreateTrainingTagRequest{
		TrainingUuid: params.TrainingUuid,
		TagName:      params.TagName,
	})
	if err != nil {
		return nil, err
	}

	return &schemas.TrainingTag{
		Name: trainingTag.GetTagName(),
	}, nil
}

type DeleteTrainingTrainingTagParams struct {
	TrainingUuid string
	TagName      string
}

func (ttts *TrainingTrainingTagService) DeleteTrainingTrainingTag(ctx context.Context, params *DeleteTrainingTrainingTagParams) error {
	in := &pb.DeleteTrainingTagRequest{
		TrainingUuid: params.TrainingUuid,
		TagName:      params.TagName,
	}
	_, err := ttts.trainingTrainingTagGRPC.DeleteTrainingTrainingTag(ctx, in)
	if err != nil {
		return err
	}

	return nil
}
