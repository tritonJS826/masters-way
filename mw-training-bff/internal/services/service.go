package services

import (
	"mw-training-bff/internal/config"
	"mw-training-bff/internal/openapi"
	pb "mw-training-bff/pkg/grpcAutogenerated/training"

	"google.golang.org/grpc"
)

type Service struct {
	GeneralService              *GeneralService
	TrainingTrainingTagService  *TrainingTrainingTagService
	TrainingStudentService      *TrainingStudentService
	TrainingMentorService       *TrainingMentorService
	TrainingService             *TrainingService
	TopicService                *TopicService
	TheoryMaterialService       *TheoryMaterialService
	PracticeMaterialService     *PracticeMaterialService
	FavoriteUserTrainingService *FavoriteUserTrainingService
}

func NewService(
	config *config.Config,
	conn *grpc.ClientConn,
) *Service {
	generalApi := openapi.MakeGeneralAPIClient(config)

	trainingTrainingTagGRPC := pb.NewTrainingTrainingTagServiceClient(conn)
	trainingStudentGRPC := pb.NewTrainingStudentServiceClient(conn)
	trainingMentorGRPC := pb.NewTrainingMentorServiceClient(conn)
	trainingGRPC := pb.NewTrainingServiceClient(conn)
	topicGRPC := pb.NewTopicsServiceClient(conn)
	theoryMaterialGRPC := pb.NewTheoryMaterialServiceClient(conn)
	practiceMaterialGRPC := pb.NewPracticeMaterialServiceClient(conn)
	favoriteUserTrainingGRPC := pb.NewFavoriteUsersTrainingsServiceClient(conn)

	return &Service{
		GeneralService:              NewGeneralService(generalApi),
		TrainingTrainingTagService:  NewTrainingTrainingTagService(trainingTrainingTagGRPC),
		TrainingStudentService:      NewTrainingStudentService(trainingStudentGRPC),
		TrainingMentorService:       NewTrainingMentorService(trainingMentorGRPC),
		TrainingService:             NewTrainingService(trainingGRPC, generalApi),
		TopicService:                NewTopicService(topicGRPC),
		TheoryMaterialService:       NewTheoryMaterialService(theoryMaterialGRPC),
		PracticeMaterialService:     NewPracticeMaterialService(practiceMaterialGRPC),
		FavoriteUserTrainingService: NewFavoriteUserTrainingService(favoriteUserTrainingGRPC),
	}
}

type PopulatedUser struct {
	UserID   string
	Name     string
	ImageURL string
}
