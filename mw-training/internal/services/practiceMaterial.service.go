package services

import (
	"context"
	db "mw-training/internal/db/sqlc"
	pb "mw-training/pkg/grpcAutoGenerated/training"

	"github.com/jackc/pgx/v5"
	"github.com/jackc/pgx/v5/pgtype"
	"github.com/jackc/pgx/v5/pgxpool"
)

type PracticeMaterialRepository interface {
	CreatePracticeMaterial(ctx context.Context, params db.CreatePracticeMaterialInTopicParams) (pb.PracticeMaterial, error)
	UpdatePracticeMaterial(ctx context.Context, params db.UpdatePracticeMaterialParams) (pb.PracticeMaterial, error)
	DeletePracticeMaterial(ctx context.Context, practiceMaterialUuid pgtype.UUID) error
	WithTx(tx pgx.Tx) *db.Queries
}

type PracticeMaterialService struct {
	practiceMaterialRepository PracticeMaterialRepository
	pgxPool                    *pgxpool.Pool
}

func NewPracticeMaterialService(pgxPool *pgxpool.Pool, practiceMaterialRepository PracticeMaterialRepository) *PracticeMaterialService {
	return &PracticeMaterialService{
		pgxPool:                    pgxPool,
		practiceMaterialRepository: practiceMaterialRepository,
	}
}

func (pms *PracticeMaterialService) CreatePracticeMaterial(ctx context.Context, params db.CreatePracticeMaterialInTopicParams) (pb.PracticeMaterial, error) {
	return pms.practiceMaterialRepository.CreatePracticeMaterial(ctx, params)
}

func (pms *PracticeMaterialService) UpdatePracticeMaterial(ctx context.Context, params db.UpdatePracticeMaterialParams) (pb.PracticeMaterial, error) {
	return pms.practiceMaterialRepository.UpdatePracticeMaterial(ctx, params)
}

func (pms *PracticeMaterialService) DeletePracticeMaterial(ctx context.Context, practiceMaterialUuid pgtype.UUID) error {
	return pms.practiceMaterialRepository.DeletePracticeMaterial(ctx, practiceMaterialUuid)
}
