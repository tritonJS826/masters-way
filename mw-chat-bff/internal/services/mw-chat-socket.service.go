package services

import (
	openapiMWChatWebSocket "mw-chat-bff/apiAutogenerated/mw-chat-websocket"
	"mw-chat-bff/internal/schemas"

	"github.com/gin-gonic/gin"
)

type MWChatWebSocketService struct {
	mwChatWebSocketAPI *openapiMWChatWebSocket.APIClient
}

func NewMWChatSocketService(mwChatWebSocketAPI *openapiMWChatWebSocket.APIClient) *MWChatWebSocketService {
	return &MWChatWebSocketService{mwChatWebSocketAPI}
}

func (mwChatWebSocketService *MWChatWebSocketService) GetChatUsers(ctx *gin.Context, roomID string, message *schemas.MessageResponse) error {
	request := openapiMWChatWebSocket.SchemasMessageResponse{
		Message: message.Message,
		// TODO:
		MessageReaders: []openapiMWChatWebSocket.SchemasMessageReader{},
		OwnerId:        message.OwnerID,
		OwnerImageUrl:  message.OwnerImageURL,
		OwnerName:      message.OwnerName,
		RoomId:         roomID,
	}
	_, err := mwChatWebSocketService.mwChatWebSocketAPI.SocketAPI.SendMessageToSocket(ctx).Request(request).Execute()
	if err != nil {
		return err
	}

	return nil
}
