package services

import (
	"fmt"
	openapiStorage "mw-chat-bff/apiAutogenerated/mw-storage"

	"github.com/gin-gonic/gin"
)

type FileService struct {
	fileAPI *openapiStorage.APIClient
}

func NewFileService(fileAPI *openapiStorage.APIClient) *FileService {
	return &FileService{fileAPI}
}

func (cs *FileService) UploadFile(ctx *gin.Context) (string, error) {
	isStream := true

	r := openapiStorage.ApiUploadFileStreamRequest{
		ApiService: cs.fileAPI.FileAPI,
		CustomConfig: &openapiStorage.CustomConfig{
			IsStream: &isStream,
			Request:  ctx.Request,
		},
	}

	filePreviewRaw, _, err := cs.fileAPI.FileAPI.UploadFileStreamExecute(r)
	if err != nil {
		return "", nil
	}

	fmt.Println(filePreviewRaw)

	// filePreview := schemas.GetRoomPreviewResponse{
	// 	UnreadMessagesAmount: filePreviewRaw.UnreadMessagesAmount,
	// }

	return "", nil
}
