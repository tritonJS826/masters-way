import {questionResultDTOToQuestionResult} from "src/dataAccessLogic/DTOToPreviewConverter/questionResultDTOToQuestionResult";
import {QuestionResult} from "src/model/businessModel/QuestionResult";
import {AIQuestionResultService} from "src/service/AIQuestionResult";

/**
 * Create question result params
 */
export interface CreateQuestionResultParams {

  /**
   * If true the answer on the question is right
   */
  isOk: boolean;

  /**
   * Question uuid
   */
  questionUuid: string;

  /**
   * Result description generated by AI or mentor
   */
  resultDescription: string;

  /**
   * Test session uuid
   */
  testSessionUuid: string;

  /**
   * Test uuid
   */
  testUuid: string;

  /**
   * User uuid
   */
  userUuid: string;

  /**
   * User's answer
   */
  userAnswer: string;

  /**
   * Language en|ru|ua
   */
  language: string;

}

/**
 * Get question results by session uuid params
 */
export interface GetQuestionResultsBySessionUuidParams {

  /**
   * Session uuid
   */
  sessionId: string;

}

/**
 * Provides methods to interact with the AiQuestionResults
 */
export class AiQuestionResultDAL {

  /**
   * Create question result
   */
  public static async createQuestionResult(params: CreateQuestionResultParams): Promise<QuestionResult> {
    const questionResultsDTO = await AIQuestionResultService.createAndCheckQuestionResult({
      request: {
        isOk: params.isOk,
        questionUuid: params.questionUuid,
        resultDescription: params.resultDescription,
        testSessionUuid: params.testSessionUuid,
        testUuid: params.testUuid,
        userUuid: params.userUuid,
        userAnswer: params.userAnswer,
        language: params.language,
      },
    });

    const questionResults = questionResultDTOToQuestionResult(questionResultsDTO);

    return questionResults;
  }

}

