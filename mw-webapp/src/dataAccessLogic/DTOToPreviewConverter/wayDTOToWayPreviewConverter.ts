import {SchemasUserPlainResponse} from "src/apiAutogenerated";
import {WayPreview} from "src/model/businessModelPreview/WayPreview";
import {WAY_TAGS_FIELD, WayDTO} from "src/model/DTOModel/WayDTO";

/**
 * WayPreview props
 */
interface WayPreviewProps {

  /**
   * Way's creator
   */
  owner: SchemasUserPlainResponse;

  /**
   * Way's current mentors
   */
  mentors: SchemasUserPlainResponse[];

}

/**
 * Convert {@link WayDTO} to {@link WayPreview}
 */
export const wayDTOToWayPreviewConverter = (wayDTO: WayDTO, wayProps: WayPreviewProps): WayPreview => {
  return new WayPreview({
    ...wayDTO,
    dayReportsAmount: wayDTO.dayReportUuids.length,
    favoriteForUsers: wayDTO.favoriteForUserUuids.length,
    metrics: [],
    owner: wayProps.owner,
    mentors: wayProps.mentors,
    lastUpdate: wayDTO.lastUpdate.toDate(),
    createdAt: wayDTO.createdAt.toDate(),
    wayTags: wayDTO[WAY_TAGS_FIELD].map((wayTag) => JSON.parse(wayTag)),
  });
};
