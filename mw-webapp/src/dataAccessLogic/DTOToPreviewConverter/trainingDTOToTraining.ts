import {MwTrainingBffInternalSchemasTraining} from "src/apiAutogenerated/training";
import {topicDTOToTopic} from "src/dataAccessLogic/DTOToPreviewConverter/topicDTOToTopic";
import {trainingTagDTOToTrainingTag} from "src/dataAccessLogic/DTOToPreviewConverter/trainingTagDTOToTrainingTag";
import {userPreviewDTOToUserPreview} from "src/dataAccessLogic/DTOToPreviewConverter/userPreviewDTOToUserPreview";
import {Training} from "src/model/businessModel/Training";
import {arrayToHashMap} from "src/utils/arrayToHashMap";

/**
 * Convert {@link trainingDTO} to {@link Training}
 */
export const trainingDTOToTraining = (
  trainingDTO: MwTrainingBffInternalSchemasTraining,
): Training => {
  const mentors = trainingDTO.mentors.map(userPreviewDTOToUserPreview);

  return new Training({
    ...trainingDTO,
    trainingTags: trainingDTO.trainingTags.map(trainingTagDTOToTrainingTag),
    createdAt: new Date(trainingDTO.createdAt),
    updatedAt: new Date(trainingDTO.updatedAt),
    owner: userPreviewDTOToUserPreview(trainingDTO.owner),
    mentors: arrayToHashMap({keyField: "uuid", list: mentors}),
    topics: trainingDTO.topics.map(topicDTOToTopic),
  });
};
