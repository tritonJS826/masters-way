import {
  MwServerInternalSchemasRefreshAccessTokenResponse,
  MwServerInternalSchemasUserPopulatedResponse,
} from "src/apiAutogenerated/general";
import {authService} from "src/service/services";
import {env} from "src/utils/env/env";

/**
 * Provides methods to interact with the Comments collection
 */
export class AuthService {

  /**
   * Call method for login by google
   */
  public static authGoogle() {
    window.location.href = `${env.API_BASE_PATH}/auth/google`;
  }

  /**
   * Call method for logout
   */
  public static async logOut() {
    await authService.logoutCurrentAuthorizedUser({provider: "google"});
  }

  /**
   * Get current authorized user data
   */
  public static async getCurrentUser(): Promise<MwServerInternalSchemasUserPopulatedResponse> {
    const user = await authService.getCurrentAuthorizedUser();

    return user;
  }

  /**
   * Refresh access token
   */
  public static async refreshToken(
    refreshToken: string,
  ): Promise<MwServerInternalSchemasRefreshAccessTokenResponse> {
    const refreshResponse = await authService.refreshAccessToken({request: {refreshToken}});

    return refreshResponse;
  }

}
