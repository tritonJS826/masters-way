package services

import (
	"context"

	openapiMail "mw-general-bff/apiAutogenerated/mw-mail"
)

type MailService struct {
	mailAPI *openapiMail.APIClient
}

func newMailService(mailAPI *openapiMail.APIClient) *MailService {
	return &MailService{mailAPI}
}

func (ss *MailService) SendMail(ctx context.Context, to []string, subject, message string) error {
	openAPIMailRequest := openapiMail.MwmailInternalSchemasMailRequest{
		Subject: subject,
		To:      to,
		Message: message,
	}

	apiRequest := ss.mailAPI.MailAPI.SendMail(ctx).Message(openAPIMailRequest)
	_, httpResp, err := apiRequest.Execute() // Стоит нраверное убрать
	if err != nil {
		if httpResp != nil {
			return err
		}
		return err
	}

	return nil
}
