package services

import (
	"context"
	openapiMail "mw-general-bff/apiAutogenerated/mw-mail"
)

type MailService struct {
	mailAPI *openapiMail.APIClient
}

func newMailService(mailAPI *openapiMail.APIClient) *MailService {
	return &MailService{mailAPI}
}

type SendMailParams struct {
	Subject string
	To      []string
	Cc      []string
	Bcc     []string
	ReplyTo []string
	Message string
}

func (ms *MailService) SendMail(ctx context.Context, params *SendMailParams) error {
	args := openapiMail.MwmailInternalSchemasMailRequest{
		Subject:    params.Subject,
		Recipients: params.To,
		Cc:         params.Cc,
		Bcc:        params.Bcc,
		Reply:      params.ReplyTo,
		Message:    params.Message,
	}

	_, _, err := ms.mailAPI.MailAPI.SendMail(ctx).Request(args).Execute()

	return err
}
