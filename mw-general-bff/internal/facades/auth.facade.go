package facades

import (
	"context"
	openapiGeneral "mw-general-bff/apiAutogenerated/general"
	"mw-general-bff/internal/services"
)

type AuthFacade struct {
	authService         *services.AuthService
	notificationService *services.NotificationService
}

func newAuthFacade(authService *services.AuthService, notificationService *services.NotificationService) *AuthFacade {
	return &AuthFacade{authService, notificationService}
}

func (af *AuthFacade) GetAuthCallbackFunction(ctx context.Context, provider, code, state string) (*openapiGeneral.MwServerInternalSchemasGetAuthCallbackFunctionResponse, error) {

	// err = ac.notificationService.CreateEnabledNotifications(ctx, authCallback.UserUuid)
	// utils.HandleErrorGin(ctx, err)

	return af.authService.GetAuthCallbackFunction(ctx, provider, code, state)
}

func (as *AuthFacade) GetUserTokenByEmail(ctx context.Context, email string) (*openapiGeneral.MwServerInternalSchemasGetUserTokenByEmailResponse, error) {

	// err = ac.notificationService.CreateEnabledNotifications(ctx, authCallback.UserUuid)
	// utils.HandleErrorGin(ctx, err)

	return as.authService.GetUserTokenByEmail(ctx, email)
}

func (as *AuthFacade) GetGoogleAuthURL(ctx context.Context, provider string) (*openapiGeneral.MwServerInternalSchemasBeginAuthResponse, error) {
	return as.authService.GetGoogleAuthURL(ctx, provider)
}

func (as *AuthFacade) GetGoogleAccessTokenByUserID(ctx context.Context) (*openapiGeneral.MwServerInternalSchemasGoogleToken, error) {
	return as.authService.GetGoogleAccessTokenByUserID(ctx)
}

func (as *AuthFacade) GetCurrentAuthorizedUserByToken(ctx context.Context) (*openapiGeneral.MwServerInternalSchemasUserPopulatedResponse, error) {
	return as.authService.GetCurrentAuthorizedUserByToken(ctx)
}

func (as *AuthFacade) Logout(ctx context.Context, provider string) error {
	return as.authService.Logout(ctx, provider)
}
